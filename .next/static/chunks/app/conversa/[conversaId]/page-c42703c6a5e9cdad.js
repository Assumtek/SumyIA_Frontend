(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{6754:function(e,a,n){Promise.resolve().then(n.bind(n,3859))},2964:function(e,a,n){"use strict";n.d(a,{$h:function(){return r},$m:function(){return b},AB:function(){return t},DO:function(){return l},Ot:function(){return d},Wu:function(){return m},X7:function(){return v},hY:function(){return h},jc:function(){return o},ju:function(){return _},nB:function(){return c},t9:function(){return i},tY:function(){return u},uP:function(){return f},vu:function(){return g},wE:function(){return p}}),n(4590);var s=n(8064);(0,s.$)("98cbaed6d7eec9bf1736d433889ef759f9a5f2b9");var r=(0,s.$)("b750959fa5a73219fdc0d11c5e017ac03d8bab6a"),t=(0,s.$)("8e2c237f55b2e559e8124b0d7f45ae94f30e79d1"),o=(0,s.$)("d84faf9caa15a43a027d95346862af46046db311"),i=(0,s.$)("38fdec02dbfd68837d05f2613310340917a8b5f8"),c=(0,s.$)("d1c373dd4cd712b80c799f165221e6872f585612"),l=(0,s.$)("51057fd333e9c8b53a3a8f5ab5ce3331a9398973"),d=(0,s.$)("43d6a0f2b6ea6cceb30c84d45fb93ad2f748ba1a"),u=(0,s.$)("aba7efd78057beb5cdc141e97cbc0ca20fab7f16"),v=(0,s.$)("3fe340c3d373d4eeafef4fb0900e4ffdf9985f97"),_=(0,s.$)("dde0c68fc34512e5cb0de7adb2a83b3fd03d16af"),f=(0,s.$)("fe12400101fa1553ba608d01fb130bcb00aed57a"),m=(0,s.$)("8e373b6eadadb7c847e1f6f0b6e5e8fe482a9389"),g=(0,s.$)("1112886395d22cd4915b7f01900c05df9b13ea37"),h=(0,s.$)("6288753f177e3717d7b7c183550e24a1be30beda"),p=(0,s.$)("f774b3796d001210d3a10f999698583484e4fd48"),b=(0,s.$)("36fae22b2ab568dcfd6a8fcf490107fe15a0d39b")},7571:function(e,a,n){"use strict";n.d(a,{Z:function(){return t}});var s=n(7437),r=n(7485);function t(e){let{texto:a="Carregando..."}=e;return(0,s.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.9)",zIndex:9999,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,s.jsx)(r.VF,{height:100,width:100,color:"#0F62FE",secondaryColor:"#0F62FE",radius:12.5,ariaLabel:"mutating-dots-loading",visible:!0}),(0,s.jsx)("h2",{style:{marginTop:24},children:a})]})}},3859:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return p}});var s=n(7437),r=n(2265),t=n(6463),o=n(7138),i=n(9298),c=n.n(i),l=n(3375);function d(){return(0,l.getCookie)("session")}var u=n(2964),v=n(9913),_=n(883),f=n(994),m=n(5962),g=n(2266),h=n(7571);function p(){let[e,a]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),[l,p]=(0,r.useState)(null),[b,x]=(0,r.useState)([]),[j,C]=(0,r.useState)(null),[N,E]=(0,r.useState)(""),[y,I]=(0,r.useState)([]),[S,w]=(0,r.useState)(!0),[A,k]=(0,r.useState)(!1),[B,M]=(0,r.useState)(!1),[$,D]=(0,r.useState)(null),[L,O]=(0,r.useState)(null),[z,F]=(0,r.useState)(""),[T,U]=(0,r.useState)(null),[Z,R]=(0,r.useState)(!1),P=(0,t.useParams)(),Y=(0,t.useRouter)(),H=(0,r.useRef)(null),V=P.conversaId,[W,X]=(0,r.useState)(!1);(0,r.useEffect)(()=>{function e(){window.innerWidth>800?X(!0):X(!1)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{(async function(){try{let e=await (0,u.nB)();e&&e.user&&D(e.user)}catch(e){console.error("Erro ao carregar dados do usu\xe1rio:",e)}})()},[]),(0,r.useEffect)(()=>{(async function(){if(V){a(!0),p(null);try{if(!d()){Y.push("/login");return}let e=await (0,u.Ot)(V);if(e&&e.mensagens){let a=e.mensagens.filter((e,a)=>!(a<1));x(a),C({id:V,secao:e.secao||"Conversa",mensagens:a})}else p("N\xe3o foi poss\xedvel carregar as mensagens"),Y.push("/conversa")}catch(a){var e,n,s;console.error("Erro ao buscar mensagens:",a),p((null===(n=a.response)||void 0===n?void 0:null===(e=n.data)||void 0===e?void 0:e.message)||"Erro ao carregar a conversa"),(null===(s=a.response)||void 0===s?void 0:s.status)===401?Y.push("/login"):Y.push("/conversa")}finally{a(!1)}}})()},[V,Y]),(0,r.useEffect)(()=>{(async function(){w(!0);try{let e=await (0,u.DO)();e&&Array.isArray(e)&&I(e)}catch(e){console.error("Erro ao buscar lista de conversas:",e)}finally{w(!1)}})()},[]),(0,r.useEffect)(()=>{H.current&&(H.current.scrollTop=H.current.scrollHeight)},[b]);let G=async e=>{if(e.preventDefault(),!N.trim()||A)return;let a=N.trim();E(""),k(!0),M(!0);let n={id:"temp-".concat(Date.now()),role:"user",content:a,createdAt:new Date().toISOString()};x(e=>[...e,n]);try{if(!d()){Y.push("/");return}let e=await (0,u.tY)(V,a);if(console.log("Resposta da API:",e),e&&e.pergunta){let a={id:"ia-".concat(Date.now()),role:"assistant",content:e.pergunta,createdAt:new Date().toISOString()};x(e=>[...e,a])}J()}catch(e){console.error("Erro ao enviar mensagem:",e),alert("N\xe3o foi poss\xedvel enviar a mensagem"),x(e=>e.filter(e=>e.id!==n.id))}finally{k(!1),M(!1)}},J=async()=>{try{let e=await (0,u.DO)();e&&Array.isArray(e)&&I(e)}catch(e){console.error("Erro ao atualizar lista de conversas:",e)}},Q=async()=>{try{if(i(!0),!d()){Y.push("/"),i(!1);return}let e=await (0,u.X7)("Nova Conversa");if(e&&e.conversaId){Y.push("/conversa/".concat(e.conversaId));return}i(!1)}catch(e){alert("N\xe3o foi poss\xedvel criar uma nova conversa"),i(!1)}},K=async()=>{try{await (0,m.k)(),Y.push("/")}catch(e){console.error("Erro ao fazer logout:",e),Y.push("/")}},q=e=>{try{return new Date(e).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}catch(e){return""}},ee=async e=>{if(z.trim()&&!Z){R(!0);try{await (0,u.wE)(e,z),I(a=>a.map(a=>a.id===e?{...a,secao:z}:a)),e===P.conversaId&&C(e=>e?{...e,secao:z}:null),O(null),F("")}catch(e){console.error("Erro ao editar nome da conversa:",e),alert("N\xe3o foi poss\xedvel editar o nome da conversa")}finally{R(!1)}}},ea=async e=>{if(!Z){R(!0);try{if(await (0,u.$m)(e),I(a=>a.filter(a=>a.id!==e)),e===P.conversaId){let a=y.filter(a=>a.id!==e);if(a.length>0)Y.push("/conversa/".concat(a[0].id));else{let e=await (0,u.X7)("Nova Conversa");e&&e.conversaId&&Y.push("/conversa/".concat(e.conversaId))}}U(null)}catch(e){console.error("Erro ao excluir conversa:",e),alert("N\xe3o foi poss\xedvel excluir a conversa")}finally{R(!1)}}};return(0,r.useEffect)(()=>{function e(){let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vr","".concat(e,"px"))}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.jsxs)("div",{className:c().pageContainer,children:[(0,s.jsxs)("div",{className:c().navMobile,children:[(0,s.jsxs)("h1",{className:c().title2,children:["SUMY",(0,s.jsx)("span",{children:"IA."})]}),(0,s.jsx)("button",{className:c().menuButton,onClick:()=>X(e=>!e),"aria-label":W?"Fechar menu":"Abrir menu",children:W?"✖":"☰"})]}),(0,s.jsxs)("div",{className:"".concat(c().sidebar," ").concat(W?c().aberta:""),children:[(0,s.jsx)("div",{className:c().logoContainer,children:(0,s.jsx)("div",{className:c().sidebarLogo,children:(0,s.jsxs)("h1",{className:c().title,children:["SUMY",(0,s.jsx)("span",{children:"IA."})]})})}),(0,s.jsxs)("div",{className:c().userInfoContainer,onClick:()=>Y.push("/profile"),children:[(0,s.jsx)("div",{className:c().userAvatar,children:$?(e=>{if(!e)return"UD";let a=e.split(" ");return 1===a.length?a[0].substring(0,2).toUpperCase():(a[0][0]+a[a.length-1][0]).toUpperCase()})($.nome):"UD"}),(0,s.jsxs)("div",{className:c().userInfo,children:[(0,s.jsx)("h4",{children:(null==$?void 0:$.nome)||"Usu\xe1rio Demo"}),(0,s.jsx)("p",{children:(null==$?void 0:$.email)||"usuario@exemplo.com"})]})]}),(0,s.jsxs)("div",{className:c().sidebarHeader,children:[(0,s.jsx)("h3",{children:"Conversas"}),(0,s.jsxs)("button",{onClick:Q,className:c().novaConversaBtn,children:[(0,s.jsx)("img",{src:"/iconplus.svg",alt:"Nova Conversa",width:18,height:18}),(0,s.jsx)("span",{className:c().btnText,children:"Nova"})]})]}),(0,s.jsx)("div",{className:c().conversasList,children:S?(0,s.jsx)("div",{className:c().carregando,children:"Carregando..."}):0===y.length?(0,s.jsx)("div",{className:c().semConversas,children:"Nenhuma conversa encontrada"}):y.map(e=>{var a,n;return(0,s.jsx)("div",{className:"".concat(c().conversaItem," ").concat(e.id===V?c().ativo:""),children:L===e.id?(0,s.jsxs)("div",{className:c().editarConversa,children:[(0,s.jsx)("input",{type:"text",value:z,onChange:e=>F(e.target.value),className:c().inputEditarConversa,placeholder:"Nome da conversa",autoFocus:!0}),(0,s.jsxs)("div",{className:c().editarBotoes,children:[(0,s.jsx)("button",{onClick:()=>ee(e.id),className:c().botaoSalvar,disabled:Z||!z.trim(),children:"Salvar"}),(0,s.jsx)("button",{onClick:()=>{O(null),F("")},className:c().botaoCancelar,children:"Cancelar"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.default,{href:"/conversa/".concat(e.id),className:c().conversaLink,children:(0,s.jsxs)("div",{className:c().conversaInfo,children:[(0,s.jsx)("h4",{children:e.secao}),(0,s.jsx)("p",{children:(null===(n=e.ultimaMensagem)||void 0===n?void 0:null===(a=n.content)||void 0===a?void 0:a.substring(0,30))||"Sem mensagens"})]})}),(0,s.jsxs)("div",{className:c().conversaAcoes,children:[(0,s.jsx)("button",{onClick:()=>{O(e.id),F(e.secao)},className:c().botaoEditar,"aria-label":"Editar conversa",children:(0,s.jsx)(v.Z,{size:16})}),(0,s.jsx)("button",{onClick:()=>U(e.id),className:c().botaoExcluir,"aria-label":"Excluir conversa",children:(0,s.jsx)(_.Z,{size:16})})]})]})},e.id)})}),(0,s.jsxs)("div",{className:c().sidebarFooter,children:[(0,s.jsxs)("button",{className:c().footerButton,onClick:()=>Y.push("/profile"),children:[(0,s.jsx)("img",{src:"/iconConfigurate.svg",alt:"Configura\xe7\xf5es",width:28,height:28}),"Configura\xe7\xf5es"]}),(0,s.jsxs)("button",{className:c().footerButton,onClick:K,children:[(0,s.jsx)("img",{src:"/iconDoor.svg",alt:"Sair",width:25,height:25}),"Sair"]})]})]}),(0,s.jsxs)("div",{className:c().chatContainer,children:[(0,s.jsx)("div",{className:c().tituloAtualChat,children:(0,s.jsx)("div",{className:c().tituloContainer,children:(0,s.jsx)("div",{children:(null==j?void 0:j.secao)||"Carregando..."})})}),(0,s.jsx)("div",{className:c().mensagens,ref:H,children:e?(0,s.jsx)("div",{className:c().carregando,children:"Carregando mensagens..."}):l?(0,s.jsx)("div",{className:c().erro,children:l}):0===b.length?(0,s.jsx)("div",{className:c().semMensagens,children:"Nenhuma mensagem encontrada"}):(0,s.jsxs)(s.Fragment,{children:[b.map(e=>(0,s.jsxs)("div",{className:"user"===e.role?c().mensagemUser:c().mensagemIA,"data-author":"user"===e.role?(null==$?void 0:$.nome)||"Usu\xe1rio Demo":"Assistente IA",children:["user"===e.role?(0,s.jsx)("p",{children:e.content}):(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:g.TU.parse(e.content)}}),(0,s.jsx)("span",{className:c().horario,children:q(e.createdAt)})]},e.id)),B&&(0,s.jsxs)("div",{className:c().digitando,children:[(0,s.jsx)("div",{className:c().bolinha}),(0,s.jsx)("div",{className:c().bolinha}),(0,s.jsx)("div",{className:c().bolinha})]})]})}),(0,s.jsxs)("form",{onSubmit:G,className:c().enviarMensagem,children:[(0,s.jsx)("input",{type:"text",value:N,onChange:e=>E(e.target.value),placeholder:"Digite sua mensagem...",className:c().inputMensagem,disabled:e||A}),(0,s.jsx)("button",{type:"submit",className:c().botaoEnviar,disabled:e||A||!N.trim(),children:A?"Enviando...":(0,s.jsx)(f.Z,{size:22})})]})]}),T&&(0,s.jsx)("div",{className:c().modalOverlay,children:(0,s.jsxs)("div",{className:c().modalContent,children:[(0,s.jsx)("h3",{children:"Confirmar exclus\xe3o"}),(0,s.jsx)("p",{children:"Tem certeza que deseja excluir esta conversa? Esta a\xe7\xe3o n\xe3o pode ser desfeita."}),(0,s.jsxs)("div",{className:c().modalBotoes,children:[(0,s.jsx)("button",{onClick:()=>ea(T),className:c().botaoConfirmarExclusao,disabled:Z,children:Z?"Excluindo...":"Sim, excluir"}),(0,s.jsx)("button",{onClick:()=>U(null),className:c().botaoCancelar,disabled:Z,children:"Cancelar"})]})]})}),e&&(0,s.jsx)(h.Z,{texto:"Carregando mensagens..."}),n&&(0,s.jsx)(h.Z,{texto:"Sua nova conversa est\xe1 sendo criada..."}),W&&(0,s.jsx)("div",{className:c().overlay,onClick:()=>X(!1),"aria-label":"Fechar menu"})]})}},5962:function(e,a,n){"use strict";n.d(a,{k:function(){return t}});var s=n(3375),r=n(2964);async function t(){try{return(0,s.deleteCookie)("session"),await (0,r.hY)(),!0}catch(e){return console.error("Erro ao fazer logout:",e),!1}}},9298:function(e){e.exports={pageContainer:"page_pageContainer__O1vYD",sidebar:"page_sidebar__kO_4g",logoContainer:"page_logoContainer__0M0vN",sidebarLogo:"page_sidebarLogo__Cs9Gr",title:"page_title__TZBtI",logoTitle:"page_logoTitle__zp3NJ",userInfoContainer:"page_userInfoContainer__uPibW",userAvatar:"page_userAvatar__55VEC",userInfo:"page_userInfo__OsQIx",sidebarHeader:"page_sidebarHeader__IKOIw",novaConversaBtn:"page_novaConversaBtn__JE36E",btnText:"page_btnText__0wIxO",sidebarFooter:"page_sidebarFooter__3M8hb",footerButton:"page_footerButton__Ja78I",footerIcon:"page_footerIcon__p7t0l",conversasList:"page_conversasList__g_W2u",conversaItem:"page_conversaItem__jGPcA",ativo:"page_ativo__ziRpZ",conversaInfo:"page_conversaInfo__sCdzH",conversaLink:"page_conversaLink___beyi",conversaAcoes:"page_conversaAcoes__Q7NSl",botaoEditar:"page_botaoEditar__Movtp",botaoExcluir:"page_botaoExcluir__DnVhE",chatContainer:"page_chatContainer___ANRC",tituloAtualChat:"page_tituloAtualChat__7SMIb",tituloContainer:"page_tituloContainer__8SREx",mensagens:"page_mensagens__0Ers6",mensagemUser:"page_mensagemUser__nN73n",mensagemIA:"page_mensagemIA__F1FCb",horario:"page_horario__KQrI8",digitando:"page_digitando__uFNUv",bolinha:"page_bolinha__NVXne",pulsar:"page_pulsar___uDbG",carregando:"page_carregando__ldLB5",erro:"page_erro__XfIJp",semMensagens:"page_semMensagens__kOLVY",semConversas:"page_semConversas__WtnRJ",enviarMensagem:"page_enviarMensagem__aBNNv",inputMensagem:"page_inputMensagem__fqVlj",botaoEnviar:"page_botaoEnviar__GTWZv",editarConversa:"page_editarConversa__3aXNo",inputEditarConversa:"page_inputEditarConversa__j_GVg",editarBotoes:"page_editarBotoes__0fL3c",botaoSalvar:"page_botaoSalvar__pgveX",botaoCancelar:"page_botaoCancelar__sSgK6",modalOverlay:"page_modalOverlay__BsQix",modalContent:"page_modalContent__sH3r4",modalBotoes:"page_modalBotoes__cNrRQ",botaoConfirmarExclusao:"page_botaoConfirmarExclusao___nzPc",menuButton:"page_menuButton__ih2iE",navMobile:"page_navMobile__PBvtW",aberta:"page_aberta__fZyYr",title2:"page_title2__yZISf",overlay:"page_overlay__RvMgt"}}},function(e){e.O(0,[454,571,138,645,708,971,23,744],function(){return e(e.s=6754)}),_N_E=e.O()}]);